<app-navbar></app-navbar>
<p-toast></p-toast>
<div class="bg-orange-100/50 -z-10">
  <div *ngIf="showPopup" class="popup-overlay"></div>
  <div *ngIf="showCakePopup" class="popup-overlay"></div>

  <!-- ตัว Popup -->
  <app-menu-popup *ngIf="showPopup" [menuId]="selectedMenuId" (onOrderSuccess)="handleOrderSuccess()" (close)="closePopup()"></app-menu-popup>
  <app-cake-popup *ngIf="showCakePopup" [cakeId]="selectedCakeId" (onOrderSuccess)="handleOrderSuccess()"(close)="closePopup()"></app-cake-popup>

  <!-- รูปตกแต่ง -->
  <div class="flex-space-between mb-12">
    <img src="../../../assets/menu_left.png" alt="">
    <div class="flex-center">
      <span class="font-seymour text-border text-redProject text-[40px] pt-16">Take a break and<br />
        enjoy your coffee!</span>
    </div>
    <img src="../../../assets/menu_right.png" alt="">
  </div>

  <!-- menu-nav -->
  <div class="flex-center relative mb-24">
    <span class="span-nav-line"></span>
    <div class="flex-center space-x-8 menu-text tracking-wider mx-12 gap-24">
      <a (click)="scrollToSection('todays-special')" class="menu-nav-section">TODAY'S SPECIAL</a>
      <a (click)="scrollToSection('beverage')" class="menu-nav-section">BEVERAGE</a>
      <a (click)="scrollToSection('cake')" class="menu-nav-section">CAKE AND BAKERY</a>
    </div>
    <span class="span-nav-line"></span>
  </div>

  <!-- SPECIAL -->
  <section id="todays-special" class="pt-24">
    <div class="text-5xl font-color pl-24">SPECIALLY CURATED MENU FOR YOU!</div>
    <div class="flex gap-40 overflow-x-auto h-96 items-center py-8 px-20">

      <div *ngFor="let item of recommendedItems">
        <div class="relative flex-center ml-24">
          <div class="rounded-3xl border-[3px] border-redProject p-5 w-[390px] h-[260px] relative flex justify-end ">
            <div class="w-[75%]">
              <p class="font-koulen text-orange-500 text-3xl text-center">{{item.name}}</p>
              <div class="flex text-2xl">
                <div class="text-start font-koulen pt-1">
                  <p>TALL</p>
                  <p>GRANDE</p>
                  <p>VENTI</p>
                </div>
                <div class="px-2">
                  <p>__________</p>
                  <p>__________</p>
                  <p>__________</p>
                </div>
                <div class="text-end  font-koulen pt-1">
                  <p>{{item.s_price}} ฿</p>
                  <p>{{item.m_price}} ฿</p>
                  <p>{{item.l_price}} ฿</p>
                </div>
              </div>
            </div>
          </div>
          <img [src]="item.photoUrl" alt="Left character" class="absolute left-[-30%] w-[220px] " />
        </div>
      </div>
    </div>
  </section>

  <!-- beverage -->
  <section id="beverage" class=" pt-24">
    <div class="text-center menu-text">BEVERAGE MENU</div>
    <div class="flex-center">

      <button (click)="prevPage('beverage')" [disabled]="currentPage === 0" class="button-custom">&lt;</button>

      <div class="grid grid-cols-3 gap-8 p-5 mx-12 font-koulen">
        <div *ngFor="let beverage of displayedMenuItems" class="menu-card">
          <div class="px-4">
            <div class="mb-2 flex-center"><img class="max-h-24 " [src]="beverage.photoUrl" alt=""></div>
            <div class="text-center">
              <div class="text-lg  ">{{ beverage.name }}</div>
              <div class="flex flex-col pt-1">
                <div>
                  <div *ngFor="let size of sizes; let i = index" class="flex text-start  pt-1">
                    <p class="w-[25%]">{{ size }}</p>
                    <span class="flex w-full border-b-2 border-black mb-2"></span>
                    <p class="w-[45%] text-end">{{ getPriceBySize(beverage, i) }} BAHT</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="flex-center  mt-auto">
            <button class="button-primary" (click)="openPopup(beverage._id)">Add to Cart</button>
          </div>
        </div>
      </div>
      <button (click)="nextPage('beverage')" [disabled]="(currentPage + 1) * itemsPerPage >= menuItems.length"
        class="button-custom">&gt;</button>
    </div>
  </section>

  <!-- cake -->
  <section id="cake" class="pt-24">
    <div class="text-center menu-text">CAKE AND BAKERY MENU</div>
    <div class="flex-center">

      <button (click)="prevPage('cake')" [disabled]="currentCakePage === 0" class="button-custom">&lt;
      </button>

      <div class="grid grid-cols-3 gap-8 p-5">
        <div *ngFor="let cake of displayedCakeItems" class="menu-card">
          <div class="px-4 font-koulen">
            <div class="mb-2 flex-center">
              <img class="max-h-32 max-w-32" [src]="cake.photoUrl" alt="">
            </div>
            <div class="w-full text-start text-xl">{{ cake.name }}</div>
            <div class="flex-space-between pt-1">
              <span class="border-line"></span>
              <p class=" pt-1 px-3 text-xl">{{ cake.price }} BAHT</p>
              <span class="border-line"></span>
            </div>
          </div>
          <div class="flex-center mt-auto">
            <button (click)="openCakePopup(cake._id)" class="button-primary">ADD TO CART</button>
          </div>
        </div>
      </div>
      <button (click)="nextPage('cake')" [disabled]="(currentCakePage + 1) * itemsPerPage >= cakeItems.length"
        class="button-custom">&gt;
      </button>
    </div>
  </section>
</div>